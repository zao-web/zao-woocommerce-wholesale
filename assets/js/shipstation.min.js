/*! Zao WooCommerce Wholesale - v0.1.0 - 2017-08-30 | https://zao.is | Copyright (c) 2017 Zao | Licensed  */

window.ZWOOWH=window.ZWOOWH||{},function(e,t,i,o,n){"use strict";o.shipStation={};var s=o.shipStation;s.cache=function(){o.$.orderItems=o.$get("woocommerce-order-items"),o.$.shipSpinner=i(".shipstation-spinner"),s.order_id=o.$get("post_ID").val()},s.init=function(){s.cache(),o.$.body.on("click","#get_shipstation_rates",s.getRates)},s.setRates=function(t){var n=o.$get("shipstation-rates").find(":selected"),a=n.data("price"),r=n.val();s.block(),i.post(e.ajaxurl,{action:"set_shipstation_rates",order_id:s.order_id,price:a,value:r,method:n.text()},function(e){o.$get("shipstation-rates").fadeOut(),s.reload_items()},"json")},s.getRates=function(t){s.spinner(),i.post(e.ajaxurl,{action:"get_shipstation_rates",order_id:s.order_id},function(t){if(o.$get("shipstation-rates").remove(),!t.success)return t.data&&t.data.msg&&e.alert(t.data.msg),s.hideSpinner();var n=i('<select id="shipstation-rates" />').insertBefore(o.$get("get_shipstation_rates"));n.append('<option value="">'+o.l10n.selectShipping+"</option>"),i.each(t.data,function(e,t){n.append('<option data-price="'+t.shipmentCost.toFixed(2)+'" value="'+t.serviceCode+'">'+t.serviceName+" - $"+t.shipmentCost.toFixed(2)+"</option>")});var a=n.select2();o.$.body.one("change",a,s.setRates),s.hideSpinner()},"json")},s.block=function(){o.$.orderItems.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},s.unblock=function(){o.$.orderItems.unblock()},s.spinner=function(){o.$.shipSpinner.addClass("is-active")},s.hideSpinner=function(){o.$.shipSpinner.removeClass("is-active")},s.reload_items=function(){s.block(),i.ajax({url:e.ajaxurl,data:{order_id:e.woocommerce_admin_meta_boxes.post_id,action:"woocommerce_load_order_items",security:e.woocommerce_admin_meta_boxes.order_item_nonce},type:"POST",success:function(e){o.$.orderItems.find(".inside").empty(),o.$.orderItems.find(".inside").append(e),s.unblock()}})},i(s.init)}(window,document,jQuery,window.ZWOOWH);