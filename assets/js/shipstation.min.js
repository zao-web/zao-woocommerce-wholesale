/*! Zao WooCommerce Wholesale - v0.1.0 - 2017-12-04 | https://zao.is | Copyright (c) 2017 Zao | Licensed  */

window.ZWOOWH=window.ZWOOWH||{},function(e,t,i,n,o){"use strict";n.shipStation={};var s=n.shipStation;s.cache=function(){n.$.orderItems=n.$get("woocommerce-order-items"),n.$.shipSpinner=i(".shipstation-spinner"),s.order_id=n.$get("post_ID").val()},s.init=function(){s.cache(),n.$.body.on("click","#get_shipstation_rates",s.getRates)},s.setRates=function(t){var o=n.$get("shipstation-rates").find(":selected"),a=o.data("price"),r=o.val();n.block(),i.post(e.ajaxurl,{action:"set_shipstation_rates",order_id:s.order_id,price:a,value:r,method:o.text()},function(e){n.$get("shipstation-rates").fadeOut(),s.reload_items()},"json")},s.getRates=function(t){s.spinner(),i.post(e.ajaxurl,{action:"get_shipstation_rates",order_id:s.order_id},function(t){if(n.$get("shipstation-rates").remove(),!t.success)return t.data&&t.data.msg&&e.alert(t.data.msg),s.hideSpinner();var o=i('<select id="shipstation-rates" />').insertBefore(n.$get("get_shipstation_rates"));o.append('<option value="">'+n.l10n.selectShipping+"</option>"),i.each(t.data,function(e,t){o.append('<option data-price="'+t.shipmentCost.toFixed(2)+'" value="'+t.serviceCode+'">'+t.serviceName+" - $"+t.shipmentCost.toFixed(2)+"</option>")});var a=o.select2();n.$.body.one("change",a,s.setRates),s.hideSpinner()},"json")},s.spinner=function(){n.$.shipSpinner.addClass("is-active")},s.hideSpinner=function(){n.$.shipSpinner.removeClass("is-active")},s.reload_items=function(){n.block(),i.ajax({url:e.ajaxurl,data:{order_id:e.woocommerce_admin_meta_boxes.post_id,action:"woocommerce_load_order_items",security:e.woocommerce_admin_meta_boxes.order_item_nonce},type:"POST",success:function(e){n.$.orderItems.find(".inside").empty(),n.$.orderItems.find(".inside").append(e),n.unblock()}})},i(s.init)}(window,document,jQuery,window.ZWOOWH);